pico-8 cartridge // http://www.pico-8.com
version 16
__lua__

palt(10, true)
mage = {}
mage.x = 32
mage.y = 16
mage.sprite = 1


bard = {}
bard.x = 48
bard.y = 16
bard.sprite = 2


paly = {}
paly.x = 64
paly.y = 16
paly.sprite = 3


priest = {}
priest.x = 80
priest.y = 16
priest.sprite = 4


manager = {}
manager.x = mage.x
manager.y = mage.y
manager.sprite = 64
manager.speed = 8


characters = {}
characters[1] = mage
characters[2] = bard
characters[3] = paly
characters[4] = priest

selection = false
debug = {}
debug.x = 0
characterselected = {}

function _init()
 cls()
 spr(manager.sprite, manager.x, manager.y)
 setstage()
end


function setstage()
 map(16, 0, 0, 0, 16, 16)
 spr(mage.sprite, mage.x, mage.y)
 spr(bard.sprite, bard.x, bard.y)
 spr(paly.sprite, paly.x, paly.y)
 spr(priest.sprite, priest.x, priest.y)
end

//function cursormove()
// if (manager.x > priest.x) then
//  manager.x = mage.x
// end
// if (manager.x < mage.x) then
//  manager.x = priest.x
//
// end
//
//end

function oncharacter(o)

 if (manager.x == o.x and manager.y == o.y) then
  characterselected = o
  selection = true
 end
end
function move(o)
debug = characterselected
 if(o.sprite == characterselected.sprite) then
  o.x = manager.x
  o.y = manager.y
 end
end
function movecharacter()
selection = false
foreach(characters,move)
end

function _update()
//
//   if not selection then
//   if btnp(0) then
//     manager.x -= manager.speed
//     cursormove()
//   end
//   if btnp(1) then 
//     manager.x += manager.speed
//     cursormove()
//   end
//  end




   if btnp(0) then
     manager.x -= manager.speed
   end
   if btnp(1) then 
     manager.x += manager.speed

   end
   if btnp(2) then 
     manager.y -= manager.speed

   end
   if btnp(3) then 
     manager.y += manager.speed
   end

   if(selection) then
    if(btnp(4)) then
     movecharacter()
     //characterselected = {}
    end
   else
    if(btnp(4)) then
      foreach(characters,oncharacter)
    end
   end

end
function _draw()
  cls()
  spr(manager.sprite, manager.x, manager.y)
  setstage()
end
__gfx__
aaaaaaaaaaa000aaaaa000aaaaa000aaaaa000aaf00000000000000ff00000000000000f00000000000000000000000000099900000888000006660000011100
aaaaaaaaa009990aaa08880aa006660aaa01110a0555099990099a00055500000055550000000000000000000000000000999f8000888f808066f66000114116
aaaaaaaa08099f90a0888f8004466f60aa0441600550999990c099a005ccc88888055550000000000000000000000000889fff994088ff80406fff6000244426
aaaaaaaa080fff90a088ff80046fff6000844460050999aa990c099405c8c8888880cc500000000000000000000000008c8fff99f43f1fb0f016f6c09aaa4486
aaaaaaaa0800e290043f1f300f6616600999886005099aa90990c0940cc8c8880888c050000000000000000000000000086556900044bb304116661f49892886
aaaaaaaa0f2ee20a0f44330a048666800989284000999000409900940088c000408cc050000000000000000000000000085556000041f33041016c1148882805
aaaaaaaa082e2220a041f3300408680a0999220a09900fff40a99094088ccf44408cc4000000000000000000000000000f05550000044b0041011c0149892204
aaaaaaaa00000000000000000000000000000000000fffff40a00094000fffff40804400000000000000000000000000085666600033bbb0401111c004928880
aa0000aaa0a000aaaaa000aaaaa000aaaaa0000a00f0ff0f4094409400ffffff40844050000000000000000000000000000000000000000000a0000000000000
a0667c0a0809990aaa08880a0446660aaa0111600040440ff40440940000f000f404400000000000000000000000000008e002e00000094000080080099aaaa0
aa060c0a08099f90a0888f8004666f60aa04416000ffffffff440094004444ffff440800000000000000000000000000888e288e00009440008a0a0004998990
a0666caa080fff90a088ff800f6fff600999446000fffff0ff40099400ffff00ff4008000000000000000000000000002888888e009444000089880004988890
0825510a0f20e290043f1f30046616600989884000fff00ff402099400fff000f403005000000000000000000000000002888880094004000898a98004998990
08266500082ee20a0f443330048666800999280a020fffff00222090030fffff0033305000000000000000000000000000288800044040000889988000499900
08250500a00e2220a041f30aa008680aa002220a00e00000e0222200033000003333330000000000000000000000000000028000044400000088880000049000
0000000000000000000000000000000000000000f00000000000000ff00000000000000f00000000000000000000000000000000000000000000000000000000
aa0000aaaaa000aaaaa000aaaaa000aaaaa000aaf00600000000000ff00000000000000f00000000000000000000000000000000000000000000000000000000
a066770aa009990aaa08880aa006660aaa01110a0506666660505500055500000005550000000000000000000000000000000000000000000000000000000000
aa060c0a0c099f90a0888f800cc66f60aa0441600550655566060550055011111110055000000000000000000000000000000000000000000000000000000000
a0666caa080fff90a088ff800c6fff60008444600506555666666600050100000111105000000000000000000000000000000000000000000000000000000000
08255c0a0800c19004cf1fc00f6616600ccc88600506666606560550050044222011110000000000000000000000000000000000000000000000000000000000
082661000f1cc10a0f44cc0a0c1666100c1c28400066600040556050050444444201110000000000000000000000000000000000000000000000000000000000
08250500081c1110a041fcc00c01610a0ccc220a0660044440650000050044400201110000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000006004f0040604000050004004201100000000000000000000000000000000000000000000000000000000000
aa0000aaa0a000aaaaa000aaaaa000aaaaa0000a004cffcf40644050050022204201020000000000000000000000000000000000000000000000000000000000
a088ee0a0c09990aaa08880a0cc6660aaa01116000fffffff4044000002224444420020000000000000000000000000000000000000000000000000000000000
aa0808c008099f90a0888f800c666f60aa0441600040000ff0600600000004444422220000000000000000000000000000000000000000000000000000000000
a08888c0080fff90a088ff800f6fff600ccc44600006666006600600499990422222205000000000000000000000000000000000000000000000000000000000
02e222c00f1cc19004cf1fc00c6616600c1c88400066006666080050499990200222005000000000000000000000000000000000000000000000000000000000
02e88810081cc10a0f44ccc00c1666100ccc280a0050550660888050000990222222805000000000000000000000000000000000000000000000000000000000
02e20200a00c1110a041fc0aa001610aa002220a0806666660888800280990008888880000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000f00000000000000ff20440000000000f00000000000000000000000000000000000000000000000000000000
cc0000cc3333333b333333333b3333bb3333b3333b333bb3c11111111111c111bbb3bbb4bbbbb3bb3bb4444b33bbbbbbbb3b444222222444444bbbb300000000
c000000c44444443444444444444443344443444434444441111211111111111bb44424444444444444444442444444bb44444b4444444444444444400000000
0000000044ffff44fffffffff4fff444fff444fff4fff4ff11111c1111111111b4cc44cccccccccccccccccccccccc434ccc2444424244444442cc1c00000000
000000004ffffff4fffffffffffffff4ffff44ffffff4fff111111ccccc111c1b4cccccccccccc1ccccccccccccccc2bcc1cc22222222222222ccccc00000000
000000004ffffffffffffffffffffff4ffffffffffffffff11c1c1ccccc11cc134ccc1c1cc1cc111cccccc11cc2ccc44cccc2444424444444422cccc00000000
000000004ffffffffffffffffffffff4ffffffffffffffff1111ccc4cccccc11bb4ccc11cc1112111cc12111c11ccc441cc1224444444444444411c100000000
c000000c4ffffffffffffffffffffff4ffffffffffffffff11cccc4344ccc111b4ccc11cc111111111c11c111111cc4b11112944999499499492111100000000
cc0000cc4ffffffffffffffffffffff4ffffffffffffffff11ccc42bb42cc111b2cc121111111111111111111111cc4b1c111222222222222221112100000000
000000004ffffffffffffffffffffff4ffffffffffffffff111ccc2bbb4ccc11b4cc111111111111111111111c11cc4b11112424244444444442cc1100000000
0cc00cc04ffffffffffffffffffffff4ffffffffffffffff11cccc4b34cc1cc1b4cc112c1111111111c1111111111c4b11114444444444444444111100000000
0c0000c04ffffffffffffffffffffff4ffffffffffffffff11cc1cc4c2cccc1134cc1c1111ccc111111111112111cc431cc1294994949929949211c100000000
000000004ffffffffffffffffffffff4ffffffffffffffff111ccccccccc1211344cccc11111111111111111111ccc4bccccc22222224222222ccccc00000000
000000004ffffffffffffffffffffff4ffffffffffffffff111c1cccccc11111b42ccc1111111111111111111111cc4bcc1c2444442444444442c1cc00000000
0c0000c04ffffffffffffffffffffff4fffffffffffffff4111111cccc11c11cb4ccc11111111c11c11111111111cc4bcccc2444444444424444cccc00000000
0cc00cc04ffffffffffffffffffffff4f4fffffffff44ff411c1111111111111b4cccc11111111111111cc2111111c43242424b444422442224224b400000000
000000004ffffffffffffffffffffff444444444444444441111111111111111bb4c1c1111111111111111111111cc4bbbbbbbbb4444422244bbbbbb00000000
880000884ffffffffffffffffffffff433333333ffffffffaaaa000000000aaab4cc11111c111111111111c11c11cc4bbbbbb444f44442444444bbbb00000000
8000000844fffffffffffffffffffff434444444ffffffffa0003bbbbb33000ab4cc111c11111c111111111111111c4bbb3b44444444444443fbbbbb00000000
00000000444ffffffffffffffffffff444ffff4fffffffffa03bbbbbb3b33b00b44c1c11111111111c1111112111cc43bbb4444444444444444bb3bb00000000
000000004ffffffffffffffffffffff44fffffffffffffff00bb1bbbbb333330b44cccc111111111cc1111c1111ccc4bbbbbbb4444444444444bbbbb00000000
000000004ffffffffffffffffffff4f4ffffffffffffffff0bbb11bbb3331330bb42cccccccc21ccc111ccccc1ccc44bbbbb444444444f4444444bbb00000000
000000004fffff4fffffffffffffff44ffffffffffffffff0b3111bb3b3331b0bb3321cccccccccccccccccccc44444bbbbb44b4444444ff444bbbbb00000000
8000000844fff4fffffffffff4ffff44fffffffffff4ff4f031bbbbbb3b33b10bbbb34444444444444cccc4444bb4433b3b444444444444444444bbb00000000
88000088444444444444444444444444ffffffff44444444033b3b3b3b3333b0bbbbbbb3bbbbb3bbbb4422bb3bbbbbbb3bbb4f44f4444444444b4bbb00000000
00000000bbbbbbbbbbbbbbbbbbbbbbbbaa0000aaaa000aaa0313b3b3b313331000000000000000000000000000000000bbbb4444444444444444bbbb00000000
00000000bbbbbbbbbbbbbbbbb3bbb3bba066550aa03bb00a033133333311313000000000000000000000000000000000bbbbbb4444444444b444b33b00000000
00000000bbbbbbbbbbbbb3bbbbbb33bba066665003bbb330a00131333111100a00000000000000000000000000000000bbbbb444444444444444bbbb00000000
00000000bbbbbbbbbbbbb3bbbb3bbbbba06115500b1bb3b0aa041111144130aa00000000000000000000000000000000bbb4b444444444444444bbbb00000000
00000000bbbbbbbbb3bbbbbbbbbbbb3b0511551003b13b30aa01444441140aaa00000000000000000000000000000000bbbbb444f4444444444bbbbb00000000
00000000bbbbbbbbbbbbbbbbbbbbbbbb055555100b3bb310aaa01444411440aa00000000000000000000000000000000bbbb44f44444f44444444b3b00000000
00000000bbbbbbbbbbbbbbbbbbbbb3bb00155100a0b3310aaa0111144144440a00000000000000000000000000000000b33bb4fb4444444444b44bbb00000000
00000000bbbbbbbbbbbbbbbbbbbbbbbba000000aaa0000aaa00000000000000000000000000000000000000000000000bbbbb444444444444f444bbb00000000
bbb000bbbbb000bbbbb000bbbbb000bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b009990bbb08880bb006660bbb01110b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08099f90b0888f8004466f60bb044160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
080fff90b088ff80046fff6000844460000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0800e290043f1f300f66166009998860000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f2ee20b0f44330b0486668009892840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
082e2220b041f3300408680b0999220b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bb0000bbbbbb000000000bbbbb000bbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b0667c0bb0003bbbbb33000bb03bb00b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bb060c0bb03bbbbbb3b33b0003bbb330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b0666cbb00bb1bbbbb3333300b1bb3b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0825510b0bbb11bbb333133003b13b30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
082665000b3111bb3b3331b00b3bb310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
08250500031bbbbbb3b33b10b0b3310b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000033b3b3b3b3333b0bb0000bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000313b3b3b3133310bb0000bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000331333333113130b066550b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000b00131333111100bb0666650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bb041111144130bbb0611550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bb01444441140bbb05115510000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bbb01444411440bb05555510000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bb0111144144440b00155100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000b000000000000000b000000b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
