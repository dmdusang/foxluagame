pico-8 cartridge // http://www.pico-8.com
version 16
__lua__


player = {
  x = 8,
  y = 88,
  sprite = 1,
  speed = 2
 }



---animation stuff ----

--object, start frame,
--num frames, speed, flip
function anim(o,sf,nf,sp,fl)
 if(not o.a_ct) o.a_ct=0
 if(not o.a_st) o.a_st=0

 o.a_ct+=1

 if(o.a_ct%(30/sp)==0) then
  o.a_st+=2
  if(o.a_st >= nf) o.a_st=0
 end

 o.a_fr=sf+o.a_st
 spr(o.a_fr,o.x,o.y,2,2,fl)
end

-------------------


---world shit ------

function gravity(fall_speed)
 player.y += fall_speed
end

function hitwall(player)
 right_wall = player.x + 16
 left_wall = player.x

 if right_wall > 128 then
  return true
 elseif left_wall < 0  then
  return false
 end

end

function onfloor(player)
position_left_x = (player.x+16)/8
position_right_x = (player.x)/8
position_y = (player.y + 16)/8

sprite_left = mget(position_left_x,position_y)
sprite_right = mget(position_right_x,position_y)
if((sprite_left == 32) or (sprite_left == 33) or (sprite_left == 34) or (sprite_left == 36) or (sprite_left == 37)) then
 return true
elseif((sprite_right == 32) or (sprite_right == 33) or (sprite_right == 34) or (sprite_right == 36) or (sprite_right == 37)) then
 return true
end

return false
end
-----------------------

--character functions--

function move()
 player.moving = true
 player.sprite += 2
 if player.sprite > 5 then
  player.sprite = 1
 end
end

function jump()
 player.y -= 16
 yield()
 player.y += 8
 yield()
 player.y -= 12
 yield()
 player.y += 4
 yield()
 player.y -= 8
 yield()
 player.y += 2
 yield()
 player.y -= 10
end

-----------------------



-------game------------
function _init()
 cls()
 map(0,0,0,0,16,16)
end

function _update()
  player.moving = false
  on_floor = onfloor(player)
  


  if on_floor then
    gravity(0)

  else
    gravity(2)
  end




  if btn(0) then
    if(hitwall(player) == false) then
    player.x -= 0
    else
    player.x -= player.speed
    end  end
  if btn(1)  then 
    if(hitwall(player) == true) then
    player.x += 0
    else
    player.x += player.speed
    end
  end
  if btn(2) and on_floor == true then
    hop = cocreate(jump)
    for i=1,7 do coresume(hop) end
    on_floor = false
  end
  if not player.moving then
   player.sprite = 1
  end
end



function _draw()
  cls()
  map(0,0,0,0,16,16)
  if btn(0) then
    anim(player,1,5,10,true)
  elseif btn(1) then
    anim(player,1,5,10)
  else
    spr(player.sprite, player.x, player.y,2,2)
  end

end



__gfx__
00000000000000000000000000000009000090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000090000900000000009900049000000000900009000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000990004900009000f4900009000000000990004900000000000000000000000000000000000000000000000000000000000000000000000000
00000000409900f49000090000f900f499999000049900f490000900000000000000000000000000000000000000000000000000000000000000000000000000
0000000000f990f49999900000ff90999099000049ff90f499999000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000ff9099909900000fff904990990ff000fff09990990000000000000000000000000000000000000000000000000000000000000000000000000000
000000000fff904990990ff004f4f044ffffff0004f4f04990990ff0000000000000000000000000000000000000000000000000000000000000000000000000
000000000ffff044ffffff00094f4f044ffff00009494044ffffff00000000000000000000000000000000000000000000000000000000000000000000000000
0000000004f4f9044ffff0000499ff4000000000099f9f044ffff000000000000000000000000000000000000000000000000000000000000000000000000000
00000000094f44400000000004499099289929900499ff4000000000000000000000000000000000000000000000000000000000000000000000000000000000
000ee0000499ff4928992900044490f0262860f04449909928992990000000000000000000000000000000000000000000000000000000000000000000000000
002eee0004499090262860900044440222288000044490f0262860f0000000000000000000000000000000000000000000000000000000000000000000000000
02e22e00004490f0222880f000044002200000900044440222288000000000000000000000000000000000000000000000000000000000000000000000000000
02e2e200000444022222800000000900000000000004400220000900000000000000000000000000000000000000000000000000000000000000000000000000
00232000000000022002000000000000000000000000009000000000000000000000000000000000000000000000000000000000000000000000000000000000
00030000000000090009000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1bbbbbbbbbbbbbbb4444444411111111bbbbbbbbbbbbbbb100000000000000000000000000000000000000000000000000000000000000000000000000000000
bbb33b333bb33b3344444444111111113bb33b333bb33b3b00000000000000000000000000000000000000000000000000000000000000000000000000000000
b3b1131113b11311444444441111111113b1131113b1131b00000000000000000000000000000000000000000000000000000000000000000000000000000000
b3314144433141444444444411111111433141444331414b00000000000000000000000000000000000000000000000000000000000000000000000000000000
31144444411444444444444411111111411444444114444300000000000000000000000000000000000000000000000000000000000000000000000000000000
14444444444444444444444411111111444444444444444100000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444411111111444444444444444200000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444411111111222222222222222100000000000000000000000000000000000000000000000000000000000000000000000000000000
333b3330333333333333333333333333333333330000000000000094002220000000000000000000000000000000000000000000000000000000000011111111
3b3b33b033333b33333333333333b3333b33b3330000900000000020002242000000000000003300000000000000000000000000000000000000030011130111
33b33bb033b3333333333333333333333b3b0b330942290000004400022220000000000000000000000000000000300000000000000000000030030010300131
3333bb00333bb3333333333333333b3333b0bb330440200004024000202220000000000000003000000000000000000003000003000000000003000011000001
b3bb00003333333b333333333b3333333bb0bbb30222000002220000002222000000000000030000000000000003000000300000030000000000000011010011
bbb00100bb3333bb333333333b333333bb0000bb2200000022000000024220200000330000300000000000000000030000000000030000000300000011310311
b00000000bbbbbb03333333333bb3333b000000b2000000020000000202442000303001000030000000000000000300000000000000300000000000011110111
00000000000000003333333333333333000000000000000000000000002220000000000000000000000000000000000000000000000000000000000011111111
__map__
2323232323232323232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323232323202124252300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323202124252323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232320212425232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2323232323232323232323232323232300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2021212121212121212424242424242500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2222222222222222222222222222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2222222222222222222222222222222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
